\chapter{The Source Code}
\label{app:A}

\singlespacing

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=DESEncryption.java]

package DES;

import java.util.ArrayList;

/**
 *
 * @author Samuel Christian
 */
public class DESEncryption {

    /**
     * ATTRIBUTES
     */

    //PC1 -> subkey permutation box
    private int[] PC1 = {
        57, 49, 41, 33, 25, 17, 9,
        1,  58, 50, 42, 34, 26, 18,
        10, 2,  59, 51, 43, 35, 27,
        19, 11, 3,  60, 52, 44, 36,
        63, 55, 47, 39, 31, 23, 15,
        7,  62, 54, 46, 38, 30, 22,
        14, 6,  61, 53, 45, 37, 29,
        21, 13, 5,  28, 20, 12, 4
    };

    //PC2 -> subkey permutatian final box
    private int[] PC2 = {
        14, 17, 11, 24, 1,  5,
        3,  28, 15, 6,  21, 10,
        23, 19, 12, 4,  26, 8,
        16, 7,  27, 20, 13, 2,
        41, 52, 31, 37, 47, 55,
        30, 40, 51, 45, 33, 48,
        44, 49, 39, 56, 34, 53,
        46, 42, 50, 36, 29, 32
    };

    //initial permutation
    private int[] IP = {
        58, 50, 42, 34, 26, 18, 10, 2,
        60, 52, 44, 36, 28, 20, 12, 4,
        62, 54, 46, 38, 30, 22, 14, 6,
        64, 56, 48, 40, 32, 24, 16, 8,
        57, 49, 41, 33, 25, 17, 9,  1,
        59, 51, 43, 35, 27, 19, 11, 3,
        61, 53, 45, 37, 29, 21, 13, 5,
        63, 55, 47, 39, 31, 23, 15, 7
    };

    //expansion P-box
    private int[] exp = {
        32, 1,  2,  3,  4,  5,
        4,  5,  6,  7,  8,  9,
        8,  9,  10, 11, 12, 13,
        12, 13, 14, 15, 16, 17,
        16, 17, 18, 19, 20, 21,
        20, 21, 22, 23, 24, 25,
        24, 25, 26, 27, 28, 29,
        28, 29, 30, 31, 32, 1
    };

    //s-boxes
    private int[][] s1 = {
        {14, 4, 14, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7},
        {0, 15, 7, 4, 14, 2, 13, 10, 3, 6, 12, 11, 9, 5, 3, 8},
        {4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0},
        {15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13}
    };
    private int[][] s2 = {
        {15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10},
        {3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5},
        {0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15},
        {13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9}
    };

    private int[][] s3 = {
        {10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8},
        {13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1},
        {13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7},
        {1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12}
    };

    private int[][] s4 = {
        {7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15},
        {13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9},
        {10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4},
        {3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14}
    };

    private int[][] s5 = {
        {2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9},
        {14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6},
        {4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14},
        {11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3}
    };

    private int[][] s6 = {
        {12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11},
        {10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8},
        {9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6},
        {4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 10, 0, 8, 13}
    };

    private int[][] s7 = {
        {4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1},
        {13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6},
        {1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2},
        {6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12}
    };

    private int[][] s8 = {
        {13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7},
        {1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 10, 14, 9, 2},
        {7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8},
        {2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11}
    };

    //straight permutation box after s-box substitution
    private int[] P = {
        16, 7,  20, 21,
        29, 12, 28, 17,
        1,  15, 23, 26,
        5,  18, 31, 10,
        2,  8,  24, 14,
        32, 27, 3,  9,
        19, 13, 30, 6,
        22, 11, 4,  25
    };

    //final permutation
    private int[] IP1 = {
        40, 8,  48, 16, 56, 24, 64, 32,
        39, 7,  47, 15, 55, 23, 63, 31,
        38, 6,  46, 14, 54, 22, 62, 30,
        37, 5,  45, 13, 53, 21, 61, 29,
        36, 4,  44, 12, 52, 20, 60, 28,
        35, 3,  43, 11, 51, 19, 59, 27,
        34, 2,  42, 10, 50, 18, 58, 26,
        33, 1,  41, 9,  49, 17, 57, 25
    };

    private String strMsg;
    private String strKey;
    private String msg;
    private String key;
    private String[] roundKey;
    private String cipher;
    private ArrayList<int[][]> sBox;
    private String[] msgBlock;

    public Encryption() {
        strMsg = "";
        strKey = "";
        msg = "";
        key = "";
        roundKey = new String[16];
        cipher = "";
        msgBlock = new String[1];

        sBox = new ArrayList<int[][]>();
        sBox.add(s1);
        sBox.add(s2);
        sBox.add(s3);
        sBox.add(s4);
        sBox.add(s5);
        sBox.add(s6);
        sBox.add(s7);
        sBox.add(s8);
    }

    public void reset() {
        strMsg = "";
        strKey = "";
        msg = "";
        key = "";
        roundKey = new String[16];
        cipher = "";
        msgBlock = new String[1];
    }

    public void encrypt() {
        createSubKey();
        String tempCipher = "";
        for(int block = 0; block < msgBlock.length; block++) {
            String init = initialPermutation(msgBlock[block]);
            String L0 = init.substring(0,init.length()/2);
            String R0 = init.substring(init.length()/2, init.length());

            //16 rounds
            String[] arr = {L0, R0};
            for(int i = 0; i < 16; i++) {
                arr = round(arr[0], arr[1], roundKey[i]);
            }

            tempCipher = arr[1] + arr[0];
            tempCipher = permute(tempCipher, IP1);
            cipher += tempCipher;
        }
    }

    public String getCipherText() {
        String cipherText = "";
        String[] temp = cipher.split("(?<=\\G.{4})");
        for(int i = 0; i < temp.length; i++) {
            cipherText += Integer.toHexString(Integer.parseInt(temp[i], 2));
        }
        return cipherText;
    }

    private String[] round(String left, String right, String rndKey) {
        String Ln = right;
        String Rn = xor(left, feistelCipher(right, rndKey));
        String[] arr = {Ln, Rn};
        return arr;
    }

    private String feistelCipher(String right, String rndKey) {
        String res = "";

        res = xor(rndKey, permute(right, exp));

        String[] B = res.split("(?<=\\G.{6})");
        String temp = "";
        for(int i = 0; i < sBox.size(); i++) {
            String index = B[i];
            int[][] sbox = sBox.get(i);
            int row = Integer.parseInt(index.charAt(0) + "" + index.charAt(index.length()-1) + "",2);
            int column = Integer.parseInt(index.substring(1, index.length()-1), 2);
            temp += String.format("%4s", Integer.toBinaryString(sbox[row][column])).replace(' ', '0');
        }

        res = permute(temp, P);

        return res;
    }

    private String initialPermutation(String msgblock) {
        String res = permute(msgblock, IP);
        return res;
    }

    private void createSubKey() {
        String K2 = permute(key, PC1);
        String left = K2.substring(0, K2.length()/2);
        String right = K2.substring(K2.length()/2, K2.length());
        for(int i = 0; i < 16 ; i++) {
            int shift = 2;
            int round = i + 1;
            if(round == 1 || round == 2 || round == 9 || round == 16) {
                shift = 1;
            }
            String leftN = leftShift(left, shift);
            String rightN = leftShift(right, shift);
            roundKey[i] = leftN+rightN;
            left = leftN;
            right = rightN;
        }

        for(int i = 0; i < roundKey.length; i++) {
            roundKey[i] = permute(roundKey[i], PC2);
        }
    }

    private String leftShift(String text, int bit) {
        String res = "";
        char[] ch = new char[text.length()];
        for(int i = 0; i < ch.length; i++) {
            int shift = (i-bit) < 0 ? text.length()+(i-bit) : (i-bit);
            ch[shift] = text.charAt(i);
        }
        res = new String(ch);
        return res;
    }

    public void initialize() {
        String tempMessage = "";
        for(int i = 0; i < strMsg.length(); i++) {
            tempMessage += String.format("%8s", Integer.toBinaryString(strMsg.charAt(i))).replace(' ', '0');
        }

        int padLength = (64 - (tempMessage.length() % 64)) / 8;
        String padding = "";
        for(int i = 0; i < padLength; i++) {
            padding += String.format("%8s", Integer.toBinaryString(32)).replace(' ', '0');
        }

        msg = tempMessage + padding;

        msgBlock = msg.split("(?<=\\G.{64})");

        for(int i = 0; i < strKey.length(); i++) {
            key += String.format("%8s", Integer.toBinaryString(strKey.charAt(i))).replace(' ', '0');
        }
    }
    public void setMessage(String m) {
        strMsg = m;
    }

    public void setKey(String k) {
        strKey = k;
    }

    private String permute(String text, int[] permutationBox) {
        String res = "";
        for(int i = 0; i < permutationBox.length; i++) {
            res += text.charAt(permutationBox[i]-1);
        }
        return res;
    }

    private String xor(String a, String b) {
        String res = "";
        for(int i = 0; i < a.length(); i++) {
            int temp1 = a.charAt(i)-48;
            int temp2 = b.charAt(i)-48;
            int xor = temp1 ^ temp2;
            res += xor;
        }
        return res;
    }
}

\end{lstlisting}

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=DESDecryption.java]

package DES;

import java.util.ArrayList;

/**
 *
 * @author Samuel Christian
 */
public class DESDecryption {

    /**
     * ATTRIBUTES
     */

    //PC1 -> subkey permutation box
    private int[] PC1 = {
        57, 49, 41, 33, 25, 17, 9,
        1,  58, 50, 42, 34, 26, 18,
        10, 2,  59, 51, 43, 35, 27,
        19, 11, 3,  60, 52, 44, 36,
        63, 55, 47, 39, 31, 23, 15,
        7,  62, 54, 46, 38, 30, 22,
        14, 6,  61, 53, 45, 37, 29,
        21, 13, 5,  28, 20, 12, 4
    };

    //PC2 -> subkey permutatian final box
    private int[] PC2 = {
        14, 17, 11, 24, 1,  5,
        3,  28, 15, 6,  21, 10,
        23, 19, 12, 4,  26, 8,
        16, 7,  27, 20, 13, 2,
        41, 52, 31, 37, 47, 55,
        30, 40, 51, 45, 33, 48,
        44, 49, 39, 56, 34, 53,
        46, 42, 50, 36, 29, 32
    };

    //initial permutation
    private int[] IP = {
        58, 50, 42, 34, 26, 18, 10, 2,
        60, 52, 44, 36, 28, 20, 12, 4,
        62, 54, 46, 38, 30, 22, 14, 6,
        64, 56, 48, 40, 32, 24, 16, 8,
        57, 49, 41, 33, 25, 17, 9,  1,
        59, 51, 43, 35, 27, 19, 11, 3,
        61, 53, 45, 37, 29, 21, 13, 5,
        63, 55, 47, 39, 31, 23, 15, 7
    };

    //expansion P-box
    private int[] exp = {
        32, 1,  2,  3,  4,  5,
        4,  5,  6,  7,  8,  9,
        8,  9,  10, 11, 12, 13,
        12, 13, 14, 15, 16, 17,
        16, 17, 18, 19, 20, 21,
        20, 21, 22, 23, 24, 25,
        24, 25, 26, 27, 28, 29,
        28, 29, 30, 31, 32, 1
    };

    //s-boxes
    private int[][] s1 = {
        {14, 4, 14, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7},
        {0, 15, 7, 4, 14, 2, 13, 10, 3, 6, 12, 11, 9, 5, 3, 8},
        {4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0},
        {15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13}
    };
    private int[][] s2 = {
        {15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10},
        {3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5},
        {0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15},
        {13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9}
    };

    private int[][] s3 = {
        {10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8},
        {13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1},
        {13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7},
        {1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12}
    };

    private int[][] s4 = {
        {7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15},
        {13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9},
        {10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4},
        {3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14}
    };

    private int[][] s5 = {
        {2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9},
        {14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6},
        {4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14},
        {11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3}
    };

    private int[][] s6 = {
        {12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11},
        {10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8},
        {9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6},
        {4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 10, 0, 8, 13}
    };

    private int[][] s7 = {
        {4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1},
        {13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6},
        {1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2},
        {6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12}
    };

    private int[][] s8 = {
        {13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7},
        {1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 10, 14, 9, 2},
        {7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8},
        {2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11}
    };

    //straight permutation box after s-box substitution
    private int[] P = {
        16, 7,  20, 21,
        29, 12, 28, 17,
        1,  15, 23, 26,
        5,  18, 31, 10,
        2,  8,  24, 14,
        32, 27, 3,  9,
        19, 13, 30, 6,
        22, 11, 4,  25
    };

    //final permutation
    private int[] IP1 = {
        40, 8,  48, 16, 56, 24, 64, 32,
        39, 7,  47, 15, 55, 23, 63, 31,
        38, 6,  46, 14, 54, 22, 62, 30,
        37, 5,  45, 13, 53, 21, 61, 29,
        36, 4,  44, 12, 52, 20, 60, 28,
        35, 3,  43, 11, 51, 19, 59, 27,
        34, 2,  42, 10, 50, 18, 58, 26,
        33, 1,  41, 9,  49, 17, 57, 25
    };

    private String key;
    private String[] roundKey;
    private String cipher;
    private ArrayList<int[][]> sBox;

    public DESDecryption() {
        key = "";
        roundKey = new String[16];
        cipher = "";

        sBox = new ArrayList<int[][]>();
        sBox.add(s1);
        sBox.add(s2);
        sBox.add(s3);
        sBox.add(s4);
        sBox.add(s5);
        sBox.add(s6);
        sBox.add(s7);
        sBox.add(s8);
    }

    public void reset() {
        key = "";
        roundKey = new String[16];
        cipher = "";
    }

    public void setCipher(String c) {
        String bin = "";
        for(int i = 0; i < c.length(); i++) {
            int hex = Integer.parseInt(c.charAt(i)+"", 16);
            String temp = String.format("%4s", Integer.toBinaryString(hex)).replace(' ', '0');
            bin += temp;
        }
        cipher = bin;
    }

    public void setKey(String k) {
        for(int i = 0; i < k.length(); i++) {
            key += String.format("%8s", Integer.toBinaryString(k.charAt(i))).replace(' ', '0');
        }
    }

    public String decrypt() {
        createSubKey();
        String plainText = "";

        String[] cipherBlock = cipher.split("(?<=\\G.{64})");

        for(int block = 0; block < cipherBlock.length; block++) {
            String init = initialPermutation(cipherBlock[block]);
            String L0 = init.substring(0,init.length()/2);
            String R0 = init.substring(init.length()/2, init.length());

            //16 rounds inverse
            String[] arr = {L0, R0};
            for(int i = 15; i >= 0; i--) {
                arr = round(arr[0], arr[1], roundKey[i]);
            }

            String tempPlainText = arr[1] + arr[0];
            tempPlainText = permute(tempPlainText, IP1);
            plainText += tempPlainText;
        }

        return plainText;
    }

    private String[] round(String left, String right, String rndKey) {
        String Ln = right;
        String Rn = xor(left, feistelCipher(right, rndKey));
        String[] arr = {Ln, Rn};
        return arr;
    }

    private String feistelCipher(String right, String rndKey) {
        String res = "";

        res = xor(rndKey, permute(right, exp));

        String[] B = res.split("(?<=\\G.{6})");
        String temp = "";
        for(int i = 0; i < sBox.size(); i++) {
            String index = B[i];
            int[][] sbox = sBox.get(i);
            int row = Integer.parseInt(index.charAt(0) + "" + index.charAt(index.length()-1) + "",2);
            int column = Integer.parseInt(index.substring(1, index.length()-1), 2);
            temp += String.format("%4s", Integer.toBinaryString(sbox[row][column])).replace(' ', '0');
        }

        res = permute(temp, P);

        return res;
    }

    private String initialPermutation(String msgblock) {
        String res = permute(msgblock, IP);
        return res;
    }

    private void createSubKey() {
        String K2 = permute(key, PC1);
        String left = K2.substring(0, K2.length()/2);
        String right = K2.substring(K2.length()/2, K2.length());
        for(int i = 0; i < 16 ; i++) {
            int shift = 2;
            int round = i + 1;
            if(round == 1 || round == 2 || round == 9 || round == 16) {
                shift = 1;
            }
            String leftN = leftShift(left, shift);
            String rightN = leftShift(right, shift);
            roundKey[i] = leftN+rightN;
            left = leftN;
            right = rightN;
        }

        for(int i = 0; i < roundKey.length; i++) {
            roundKey[i] = permute(roundKey[i], PC2);
        }
    }

    private String leftShift(String text, int bit) {
        String res = "";
        char[] ch = new char[text.length()];
        for(int i = 0; i < ch.length; i++) {
            int shift = (i-bit) < 0 ? text.length()+(i-bit) : (i-bit);
            ch[shift] = text.charAt(i);
        }
        res = new String(ch);
        return res;
    }

    private String permute(String text, int[] permutationBox) {
        String res = "";
        for(int i = 0; i < permutationBox.length; i++) {
            res += text.charAt(permutationBox[i]-1);
        }
        return res;
    }

    private String xor(String a, String b) {
        String res = "";
        for(int i = 0; i < a.length(); i++) {
            int temp1 = a.charAt(i)-48;
            int temp2 = b.charAt(i)-48;
            int xor = temp1 ^ temp2;
            res += xor;
        }
        return res;
    }

    public String binToStr(String bin) {
        String text = "";
        String[] temp = bin.split("(?<=\\G.{8})");
        for(int i = 0; i < temp.length; i++) {
            text += (char)Integer.parseInt(temp[i], 2);
        }
        return text;
    }
}

\end{lstlisting}

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=DataReader.java]

package ReaderWriter;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;

/**
 *
 * @author Samuel Christian
 */
public class DataReader {

    /**
     * ATTRIBUTES
     */
    private String filename;
    private ArrayList<String> content;

    public DataReader(String file) {
        filename = file;
        content = new ArrayList<String>();
    }

    public String[] get() {
        String[] str = new String[content.size()];
        for(int i = 0; i < str.length; i++) {
            str[i] = content.get(i);
        }
        return str;
    }

    public void read() {
        BufferedReader br = null;
        try {
            String sCurrentLine;
            br = new BufferedReader(new FileReader(filename));
            while ((sCurrentLine = br.readLine()) != null) {
                content.add(sCurrentLine);
            }
        } catch (IOException e) {
        } finally {
            try {
                if (br != null) {
                    br.close();
                }
            } catch (IOException ex) {
            }
        }
    }
}

\end{lstlisting}

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=DataWriter.java]

package ReaderWriter;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

/**
 *
 * @author Samuel Christian
 */
public class DataWriter {

    /**
     * ATTRIBUTES
     */
    private String filename;
    private String content;

    public DataWriter(String name) {
        filename = name;
    }

    public void write(String text) throws IOException {
        content = text;
        try {
            File file = new File(filename);
            
            file.createNewFile();

            FileWriter fw = new FileWriter(file.getAbsoluteFile(), false);
            BufferedWriter bw = new BufferedWriter(fw);
            bw.write(content);
            bw.close();

            System.out.println("Done");

        } catch (IOException e) {
        }
    }
}

\end{lstlisting}

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=Sha512.java]

package SHA512;

import java.math.BigInteger;

/**
 *
 * @author Samuel Christian
 */
public class Sha512 {

    /**
     * ATTRIBUTES
     */

    /*Initial values*/
    private static final long[] INITIALS = {0x6a09e667f3bcc908L,
                                            0xbb67ae8584caa73bL,
                                            0x3c6ef372fe94f82bL,
                                            0xa54ff53a5f1d36f1L,
                                            0x510e527fade682d1L,
                                            0x9b05688c2b3e6c1fL,
                                            0x1f83d9abfb41bd6bL,
                                            0x5be0cd19137e2179L};

    /*Constants for 80 rounds in sha512*/
    private static final long[] CONSTANTS  =
                                  {0x428a2f98d728ae22L, 0x7137449123ef65cdL, 0xb5c0fbcfec4d3b2fL, 0xe9b5dba58189dbbcL,
                                   0x3956c25bf348b538L, 0x59f111f1b605d019L, 0x923f82a4af194f9bL, 0xab1c5ed5da6d8118L,
                                   0xd807aa98a3030242L, 0x12835b0145706fbeL, 0x243185be4ee4b28cL, 0x550c7dc3d5ffb4e2L,
                                   0x72be5d74f27b896fL, 0x80deb1fe3b1696b1L, 0x9bdc06a725c71235L, 0xc19bf174cf692694L,
                                   0xe49b69c19ef14ad2L, 0xefbe4786384f25e3L, 0x0fc19dc68b8cd5b5L, 0x240ca1cc77ac9c65L,
                                   0x2de92c6f592b0275L, 0x4a7484aa6ea6e483L, 0x5cb0a9dcbd41fbd4L, 0x76f988da831153b5L,
                                   0x983e5152ee66dfabL, 0xa831c66d2db43210L, 0xb00327c898fb213fL, 0xbf597fc7beef0ee4L,
                                   0xc6e00bf33da88fc2L, 0xd5a79147930aa725L, 0x06ca6351e003826fL, 0x142929670a0e6e70L,
                                   0x27b70a8546d22ffcL, 0x2e1b21385c26c926L, 0x4d2c6dfc5ac42aedL, 0x53380d139d95b3dfL,
                                   0x650a73548baf63deL, 0x766a0abb3c77b2a8L, 0x81c2c92e47edaee6L, 0x92722c851482353bL,
                                   0xa2bfe8a14cf10364L, 0xa81a664bbc423001L, 0xc24b8b70d0f89791L, 0xc76c51a30654be30L,
                                   0xd192e819d6ef5218L, 0xd69906245565a910L, 0xf40e35855771202aL, 0x106aa07032bbd1b8L,
                                   0x19a4c116b8d2d0c8L, 0x1e376c085141ab53L, 0x2748774cdf8eeb99L, 0x34b0bcb5e19b48a8L,
                                   0x391c0cb3c5c95a63L, 0x4ed8aa4ae3418acbL, 0x5b9cca4f7763e373L, 0x682e6ff3d6b2b8a3L,
                                   0x748f82ee5defb2fcL, 0x78a5636f43172f60L, 0x84c87814a1f0ab72L, 0x8cc702081a6439ecL,
                                   0x90befffa23631e28L, 0xa4506cebde82bde9L, 0xbef9a3f7b2c67915L, 0xc67178f2e372532bL,
                                   0xca273eceea26619cL, 0xd186b8c721c0c207L, 0xeada7dd6cde0eb1eL, 0xf57d4f7fee6ed178L,
                                   0x06f067aa72176fbaL, 0x0a637dc5a2c898a6L, 0x113f9804bef90daeL, 0x1b710b35131c471bL,
                                   0x28db77f523047d84L, 0x32caab7b40c72493L, 0x3c9ebe0a15c9bebcL, 0x431d67c49c100d4cL,
                                   0x4cc5d4becb3e42b6L, 0x597f299cfc657e2aL, 0x5fcb6fab3ad6faecL, 0x6c44198c4a475817L};

    private String originalMessage;
    private String lengthMessage;
    private String paddingMessage;
    private String message;
    private String[] messageBlock;
    private String digest;

    public Sha512() {
        message = "";
        lengthMessage = "";
        paddingMessage = "";
        originalMessage = "";
        digest = "";
    }

    public void setMessage(String m) {
        reset();
        message = m;
    }

    public void reset() {
        message = "";
        lengthMessage = "";
        paddingMessage = "";
        originalMessage = "";
        digest = "";
    }

    public String getDigest() {
        String text = "";
        for(int i = 0; i < digest.length(); i+=4) {
            String bits = digest.substring(i, i+4);
            text += Long.toHexString(longValue(bits));
        }
        return text;
    }

    public void createDigest() {
        initialize(message);
        String[] finalDigest = new String[INITIALS.length];
        for(int countBlock = 0; countBlock < messageBlock.length; countBlock++) {
            String block = messageBlock[countBlock];
            String[] words = wordsExpansion(block);
            String[] first = finalDigest;
            
            //initialize first digest
            if(countBlock == 0) {
                for(int i = 0; i < finalDigest.length; i++) {
                    finalDigest[i] = pad(Long.toBinaryString(INITIALS[i]));
                }
            }

            //80 rounds
            for(int i = 0; i < words.length; i++) {
                finalDigest = round(finalDigest, longValue(words[i]), i);
            }

            //final adding
            for(int i = 0; i < finalDigest.length; i++) {
                finalDigest[i] = pad(Long.toBinaryString(longValue(finalDigest[i]) + longValue(first[i])));
            }
        }
        for(int i = 0; i < finalDigest.length; i++) {
            digest += finalDigest[i] + "";
        }
    }

    private String[] wordsExpansion(String block) {
        String[] words = new String[80];
        for(int i = 0; i < 16; i++) {
            int start = i * 64;
            int end = start + 64;
            words[i] = block.substring(start, end);
        }
        for(int i = 16; i < words.length; i++) {
            //i-16
            long w1 = longValue(words[i-16]);

            //RotShift_1-8-7(i-15)
            long w2 = rotShift(longValue(words[i-15]), 1, 8, 7);

            //i-7
            long w3 = longValue(words[i-7]);

            //RotShift_19-61-6(i-2)
            long w4 = rotShift(longValue(words[i-2]), 19, 61, 6);

            long temp = w1 ^ w2 ^ w3 ^ w4;
            words[i] = pad(Long.toBinaryString(temp));
        }

        return words;
    }

    //preDigest: previous digest or initial digest
    //prevDigest[0] -> A    prevDigest[1] -> B    prevDigest[2] -> C    prevDigest[3] -> D
    //prevDigest[4] -> E    prevDigest[5] -> F    prevDigest[6] -> G    prevDigest[7] -> H
    private String[] round(String[] prevDigest, long word, int numOfRounds) {
        String[] result = new String[8];
        result[1] = pad(prevDigest[0]); //A -> B
        result[2] = pad(prevDigest[1]); //B -> C
        result[3] = pad(prevDigest[2]); //C -> D
        result[5] = pad(prevDigest[4]); //E -> F
        result[6] = pad(prevDigest[5]); //F -> G
        result[7] = pad(prevDigest[6]); //G -> H

        //compute Y -> E (prevDigest[4])
        //conditional(E,F,G)
        long cond = conditional(longValue(prevDigest[4]),longValue(prevDigest[5]),longValue(prevDigest[6]));
        //rotate(E)
        long rot_E = rotate(longValue(prevDigest[4]));
        //addition modulo 2^64
        //temp1 = H + cond(E,F,G) + rotate(E) + w_i + K_i
        long temp1 = longValue(prevDigest[7]) + cond + rot_E + word + CONSTANTS[numOfRounds];
        //Y = temp1 + D
        long Y = temp1 + longValue(prevDigest[3]);
        //Y -> E
        result[4] = pad(Long.toBinaryString(Y));

        //compute X -> A (prevDigest[0])
        //majority(A,B,C)
        long maj = majority(longValue(prevDigest[0]),longValue(prevDigest[1]),longValue(prevDigest[2]));
        //rotate(A)
        long rot_A = rotate(longValue(prevDigest[0]));
        //temp2 = majority(A,B,C) + rotate(A)
        long temp2 = maj + rot_A;
        //X = temp1 + temp2
        long X = temp1 + temp2;
        //X -> A
        result[0] = pad(Long.toBinaryString(X));

        return result;
    }

    /*WORD EXPANSION FUNCTIONS*/
    //RotShift_l-m-n(x) = RotR_l(x) XOR RotR_m(x) XOR ShL_n(x)
    private long rotShift(long x, long l, long m, long n) {
        long res = rotR(x,l) ^ rotR(x,m) ^ shL(x,n);
        return x;
    }
    //Rotate right x by n bits
    private long rotR(long x, long n) {
        return (((x) >>> n) | ((x) << (64 - n)));
    }
    //Shift left x by n bits
    private long shL(long x, long n) {
        return x << n;
    }
    /*END*/

    /*ROUND FUNCTIONS*/
    //MAJORITY(x,y,z) = (x AND y) XOR (y AND z) XOR (z AND x)
    private long majority(long x, long y, long z) {
        return ((x & y) ^ (y & z) ^ (z & x));
    }
    //CONDITIONAL(x,y,z) = (x AND y) XOR (NOT x AND z)
    private long conditional(long x, long y, long z) {
        return ((x & y) ^ ((~x) & z));
    }
    //ROTATE(x) = RotR_28(x) XOR RotR_34(x) XOR RotR_29(x)
    private long rotate(long x) {
        long res = rotR(x,28) ^ rotR(x,34) ^ rotR(x,29);
        return res;
    }
    /*END*/

    private long longValue(String s) {
        return new BigInteger(s,2).longValue();
    }

    private void initialize(String msg) {
        for(int i = 0; i < msg.length(); i++) {
            originalMessage += Integer.toBinaryString(msg.charAt(i));
        }

        lengthMessage = Integer.toBinaryString(originalMessage.length());
        if(lengthMessage.length() != 128) {
            int addBit = 128 - lengthMessage.length();
            String add = "";
            for(int i = 0; i < addBit; i++) {
                add += "0";
            }
            lengthMessage = add + lengthMessage;
        }

        paddingMessage = "1";
        int paddingLength = (((-originalMessage.length()-128) % 1024 + 1024) % 1024) - 1;
        for(int i = 0; i < paddingLength; i++) {
            paddingMessage += "0";
        }

        message = originalMessage + paddingMessage + lengthMessage;

        messageBlock = new String[message.length()/1024];
        for(int i = 0; i < messageBlock.length; i++) {
            int start = i*1024;
            int end = start+1024;
            messageBlock[i] = message.substring(start, end);
        }
    }

    private String pad(String input) {
        String res = "";
        int add = 0;
        if(input.length() % 8 != 0) {
            add = 8 - (input.length()%8);
        }
        for(int i = 0; i < add; i++) {
            res += "0";
        }
        res += input;
        return res;
    }
}

\end{lstlisting}

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=Function.java]

package ShamirSecretSharing;

/**
 *
 * @author Samuel Christian
 */
public class Function {

    /**
     * ATTRIBUTES
     */
    private int[] function;

    /**
     * CONSTRUCTOR
     */
    public Function(int[] func) {
        function = func;
    }

    /**
     * OTHERS
     */
    //f(x) = res
    public int countFunction(int x) {
        int res = 0;
        for(int i = 0; i < function.length; i++) {
            res += function[i] * Math.pow(x,i);
        }
        return res;
    }
}

\end{lstlisting}

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=EquationSolver.java]

package ShamirSecretSharing;

/**
 *
 * @author Samuel Christian
 */
public class EquationSolver {

    /**
     * ATTRIBUTES
     */
    private double[][] equationMatrix;
    private double[] solutionMatrix;

    public EquationSolver(double[][] equation, double[] solution) {
        equationMatrix = equation;
        solutionMatrix = solution;
    }

    public void reset() {
        equationMatrix = new double[1][1];
        solutionMatrix = new double[1];
    }

    public double[] solve() {
        int n = solutionMatrix.length;
        for(int k = 0; k < n; k++) {
            /*set pivot row*/
            int max = k;
            for(int row = k+1; row < n; row++) {
                if(Math.abs(equationMatrix[row][k]) > Math.abs(equationMatrix[max][k])) {
                    max = row;
                }
            }

            /*swap with pivot row matrix A*/
            double[] temp = equationMatrix[max];
            equationMatrix[max] = equationMatrix[k];
            equationMatrix[k] = temp;

            /*swap solution matrix B*/
            double tmp = solutionMatrix[max];
            solutionMatrix[max] = solutionMatrix[k];
            solutionMatrix[k] = tmp;

            /*set matrix into triangle matrix*/
            for (int row = k+1; row < n; row++) {
                double factor = equationMatrix[row][k] / equationMatrix[k][k];
                solutionMatrix[row] -= factor * solutionMatrix[k];
                for (int col = k; col < n; col++) {
                    equationMatrix[row][col] -= factor * equationMatrix[k][col];
                }
            }
        }

        /*substitution to find solution*/
        double[] solution = new double[n];

        for (int row = n - 1; row >= 0; row--) {
            double sum = 0.0;
            for (int j = row + 1; j < n; j++) {
                sum += equationMatrix[row][j] * solution[j];
            }
            solution[row] = (solutionMatrix[row] - sum) / equationMatrix[row][row];
        }
        return solution;
    }
}

\end{lstlisting}

\begin{lstlisting}[language=Java,basicstyle=\tiny,caption=SecretSharing.java]

package ShamirSecretSharing;

import java.util.ArrayList;

/**
 *
 * @author Samuel Christian
 */
public class SecretSharing {

    /**
     * ATTRIBUTES
     */
    private int[] function;
    private int[] fx;
    private int secret;
    private EquationSolver solver;

    /**
     * CONSTRUCTOR
     */
    public SecretSharing(int s) {
        secret = s;
    }
    public SecretSharing() {
    }

    /**
     * ACCESSOR
     */
    public int[] getFunction() {
        return function;
    }
    public int[] getFx() {
        return fx;
    }

    /**
     * OTHERS
     */
    public void split(int share, int k) {
        function = new int[k];
        function[0] = secret;
        for(int i = 1; i < function.length; i++) {
            function[i] = (int)(Math.random()*50) + 1;
        }

        Function fcount = new Function(function);
        //f(0) is secret
        fx = new int[share+1];
        for(int i = 0; i <= share; i++) {
            fx[i] = fcount.countFunction(i);
        }
    }

    public String reconstruct(int n, int k, ArrayList<double[]> parts) {
        ArrayList<double[]> functions = new ArrayList<double[]>();
        for(int a = 1; a <= n; a++) {
            double[] f = new double[k];
            for(int x = 0; x < f.length; x++) {
                f[x] = Math.pow(a, x);
            }
            functions.add(f);
        }

        double[][] equation = new double[k][k];
        int idx = 0;
        double[] tempPasswordPart = parts.get(0);
        for(int i = 0; i < tempPasswordPart.length; i++) {
            if(tempPasswordPart[i] != -1 && idx < equation.length) {
                equation[idx] = functions.get(i);
                idx++;
            }
        }

        int[] finalPart = new int[parts.size()];
        for(int i = 0; i < parts.size(); i++) {
            double[] temp = parts.get(i);
            double[] solution = new double[k];
            double[][] tempEq = new double[k][k];
            for(int row = 0; row < equation.length; row++) {
                for(int col = 0; col < equation[row].length; col++) {
                    tempEq[row][col] = equation[row][col];
                }
            }

            idx = 0;
            for(int c = 0; c < temp.length; c++) {
                if(temp[c] != -1 && idx < solution.length) {
                    solution[idx] = temp[c];
                    idx++;
                }
            }
            solver = new EquationSolver(tempEq, solution);
            finalPart[i] = (int)solver.solve()[0];
        }

        String forgottenPassword = "";
        for(int i = 0; i < finalPart.length; i++) {
            if(finalPart[i] != 0) {
                char ch = (char)finalPart[i];
                forgottenPassword += ch + "";
            }
        }
        return forgottenPassword;
    }
}

\end{lstlisting}

\begin{lstlisting}[language=HTML,basicstyle=\tiny,caption=index.jsp]

<%-- 
    Document   : index
    Author     : Sam
--%>

<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Secret Sharing</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/normalize.css" rel="stylesheet">
        <link href="css/font-awesome.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div class="container main-container">
            <div class="main-menu-links">
                <a href="pages/retrieve.jsp" class="btn btn-success">Retrieve Password</a>
                or
                <a href="pages/store.jsp" class="btn btn-info">Store Password</a>
            </div>
        </div>
    </body>
</html>

\end{lstlisting}

\begin{lstlisting}[language=html,basicstyle=\tiny,caption=store.jsp]

<%-- 
    Document   : store
    Author     : Sam
--%>

<%@page import="ReaderWriter.DataReader" %>
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Secret Sharing</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/normalize.css" rel="stylesheet">
        <link href="../css/font-awesome.css" rel="stylesheet">
        <link href="../css/style.css" rel="stylesheet">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div class="container">
            <div class="login-box col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
                <div class="panel panel-info" style="margin-top:20px;">
                    <div class="panel-heading">
                        <div class="panel-title">Store Password</div>
                    </div>
                    <form method="POST" action="process.jsp" onsubmit="return count()">
                        <div class="panel-body">
                            <input type="button" style="margin-left: 12px;" class="btn btn-primary" id="addPassword" value="Add Password"/>
                            <hr class="pswd-hr"/>
                            <div class="form-group">
                                <label style="margin-top:7px;" class="col-sm-7 control-label">Security Questions</label>
                            </div>
                            <div style="display:none;" id="counter">1</div>
                            <div class="form-group">
                                <div class="col-sm-9"><input type="text" id="question" class="form-control" placeholder="Question Here"/></div>
                                <div class="col-sm-2"><input type="button" id="add" class="btn btn-primary" value="Add"/></div>
                            </div>
                            <hr class="submit-buttons-hr"/>
                            <div class="form-group">
                                <input type="submit" class="btn btn-info" value="Store"/>
                                <a class="btn btn-danger" href="../index.jsp">Cancel</a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <script src="../js/jquery-2.1.1.js" type="text/javascript"></script>
	<script src="../js/bootstrap.min.js" type="text/javascript"></script>
        <script src="../js/app.js" type="text/javascript"></script>
    </body>
</html>

\end{lstlisting}

\begin{lstlisting}[language=html,basicstyle=\tiny,caption=process.jsp]

<%-- 
    Document   : process
    Author     : Sam
--%>

<%@page import="java.util.Arrays"%>
<%@page import="ReaderWriter.DataWriter"%>
<%@page import="ReaderWriter.DataReader"%>
<%@page import="SHA512.Sha512"%>
<%@page import="DES.DESEncryption"%>
<%@page import="ShamirSecretSharing.SecretSharing"%>
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
        <title>Secret Sharing</title>
    </head>
    <body>
        <%
            String[] passwords = request.getParameterValues("password");
            String[] questions = request.getParameterValues("questions");
            String[] answers = request.getParameterValues("answer");
            String path = getServletContext().getRealPath("data");

            int n = questions.length;
            int k = passwords.length/2+1;
            if(k <= 3) {
                k = 4;
            }

            int salt = (int)(Math.random()*50) + 10;

            String[] hashValue = new String[answers.length];
            Sha512 sha = new Sha512();
            for(int i = 0; i < hashValue.length; i++) {
                String message = questions[i] + answers[i] + salt;
                sha.setMessage(message);
                sha.createDigest();
                hashValue[i] = sha.getDigest();
                sha.reset();
            }

            DataWriter dw = null;
            String writeToFile = "";
            DESEncryption e = new DESEncryption();
            for(int count = 0; count < passwords.length; count++) {
                String password = passwords[count];
                String[] encrypted = new String[password.length()*n];
                
                int secret = 0;
                int encIdx = 0;
                for(int i = 0; i < password.length(); i++) {
                    secret = (int)(password.charAt(i));
                    SecretSharing ss = new SecretSharing(secret);
                    ss.split(n, k);

                    int[] function = ss.getFunction();
                    int[] shares = ss.getFx();

                    for(int j = 1; j < shares.length; j++) {
                        e.setMessage(shares[j]+"");
                        e.setKey(hashValue[j-1]);
                        e.initialize();
                        e.encrypt();
                        encrypted[encIdx] = e.getCipherText();
                        encIdx++;
                        e.reset();
                    }
                }

                //save answers
                writeToFile = "";
                for(int i = 0; i < encrypted.length; i++) {
                    writeToFile += encrypted[i] + "\r\n";
                }
                dw = new DataWriter(path + "\\data_answers_" + count + ".txt");
                dw.write(writeToFile);
            }

            //save questions
            writeToFile = "";
            for(int i = 0; i < questions.length; i++) {
                writeToFile += questions[i] + "\r\n";
            }
            dw = new DataWriter(path + "\\data_questions.txt");
            dw.write(writeToFile);

            //save salt and min question
            writeToFile = salt + "\r\n" + k;
            dw = new DataWriter(path + "\\data_others.txt");
            dw.write(writeToFile);

            response.sendRedirect("../index.jsp");
        %>
    </body>
</html>

\end{lstlisting}

\begin{lstlisting}[language=html,basicstyle=\tiny,caption=retrieve.jsp]

<%--
    Document   : retrieve
    Author     : Sam
--%>

<%@page import="ReaderWriter.DataReader"%>
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Secret Sharing</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/normalize.css" rel="stylesheet">
        <link href="../css/font-awesome.css" rel="stylesheet">
        <link href="../css/style.css" rel="stylesheet">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div class="container">
            <div class="login-box col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
                <div class="panel panel-info" style="margin-top:20px;">
                    <div class="panel-heading">
                        <div class="panel-title">Retrieve Password</div>
                    </div>
                    <form action="retrieve_process.jsp" method="POST">
                        <div class="panel-body">
                            <div class="form-group">
                                <label style="margin-top:7px;" class="col-sm-7 control-label">Security Questions</label>
                            </div>
                            <%
                                String path = getServletContext().getRealPath("data");
                                DataReader dr = new DataReader(path + "\\data_questions.txt");
                                dr.read();
                                String[] questions = dr.get();
                                for(int i = 0; i < questions.length; i++) {
                            %>
                                    <div class="form-group">
                                        <label for="num" style="margin-top:7px;" class="col-sm-1 control-label"><%= (i+1) + "." %></label>
                                        <label for="answer" style="margin-top:7px;" class="col-sm-7 control-label"><%= questions[i] %></label>
                                        <div class="col-sm-4"><input id="ans" name="answer" type="text" class="form-control"/></div>
                                        <input type="hidden" name="questions" value="<%= questions[i] %>"/>
                                    </div>
                            <%
                                }
                            %>
                            <hr/>
                            <div class="form-group">
                                <input type="submit" class="btn btn-info" value="Submit"/>
                                <a class="btn btn-danger" href="../index.jsp">Cancel</a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </body>
</html>

\end{lstlisting}

\begin{lstlisting}[language=html,basicstyle=\tiny,caption=retrieve\_process.jsp]

<%-- 
    Document   : retrieve_process
    Author     : Sam
--%>

<%@page import="ShamirSecretSharing.SecretSharing"%>
<%@page import="ShamirSecretSharing.EquationSolver"%>
<%@page import="java.util.ArrayList"%>
<%@page import="java.io.FilenameFilter"%>
<%@page import="java.io.File"%>
<%@page import="java.util.Arrays"%>
<%@page import="DES.DESDecryption"%>
<%@page import="SHA512.Sha512"%>
<%@page import="ReaderWriter.DataReader"%>
<%@page contentType="text/html" pageEncoding="windows-1252"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Secret Sharing</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/normalize.css" rel="stylesheet">
        <link href="../css/font-awesome.css" rel="stylesheet">
        <link href="../css/style.css" rel="stylesheet">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div class="container">
            <div class="login-box col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2">
                <div class="panel panel-info" style="margin-top:20px;">
                    <div class="panel-heading">
                        <div class="panel-title">Retrieve Password</div>
                    </div>
                    <div class="panel-body">
                        <%
                            String path = getServletContext().getRealPath("data");
                            File folder = new File(path);
                            File[] listPassword = folder.listFiles(new FilenameFilter() {
                                @Override
                                public boolean accept(File dir, String name) {
                                    return (name.contains("data_answers") && name.endsWith(".txt")) && (!name.contains("case"));
                                }
                            });
                            
                            String[] answers = request.getParameterValues("answer");
                            String[] questions = request.getParameterValues("questions");
                            int n = answers.length;

                            DataReader dr = new DataReader(path + "\\data_others.txt");
                            dr.read();
                            int salt = Integer.parseInt(dr.get()[0]);
                            int k = Integer.parseInt(dr.get()[1]);

                            String[] hashValue = new String[answers.length];
                            Sha512 sha = new Sha512();
                            for(int i = 0; i < answers.length; i++) {
                                String msg = questions[i] + answers[i] + salt;
                                sha.setMessage(msg);
                                sha.createDigest();
                                hashValue[i] = sha.getDigest();
                                sha.reset();
                            }

                            int[] decryptedAnswers = new int[1];
                            ArrayList<double[]> passwordPart = new ArrayList<double[]>();
                            SecretSharing ss = new SecretSharing();
                            String[] passwords = new String[listPassword.length];
                            for(int passCount = 0; passCount < listPassword.length; passCount++) {
                                passwordPart = new ArrayList<double[]>();
                                dr = new DataReader(listPassword[passCount].getAbsolutePath());
                                dr.read();
                                String[] encryptedAnswers = dr.get();
                                decryptedAnswers = new int[encryptedAnswers.length];

                                DESDecryption d = new DESDecryption();
                                int count = 0;
                                for(int j = 0; j < encryptedAnswers.length; j++) {
                                    d.setCipher(encryptedAnswers[j]);
                                    d.setKey(hashValue[count]);
                                    try {
                                        decryptedAnswers[j] = Integer.parseInt(d.binToStr(d.decrypt()).trim());
                                    } catch(NumberFormatException nfe) {
                                        decryptedAnswers[j] = -1;
                                    }
                                    d.reset();
                                    if(count == hashValue.length-1) {
                                        count = 0;
                                    } else {
                                        count++;
                                    }
                                }

                                for(int j = 0; j < decryptedAnswers.length; ) {
                                    double[] temp = new double[n];
                                    for(int idx = 0; idx < n; idx++) {
                                        temp[idx] = decryptedAnswers[j];
                                        j++;
                                    }
                                    passwordPart.add(temp);
                                }
                                
                                passwords[passCount] = ss.reconstruct(n, k, passwordPart);
                            }
                        %>
                        <%
                            for(int i = 0; i < passwords.length; i++) {
                        %>
                            <% if(passwords[i] == "") { %>
                                <div class="form-group">
                                    <div class="failed-notification">Password cannot be retrieved</div>
                                </div>
                                <% i = passwords.length; %>
                            <% } else { %>
                                <div class="form-group">
                                    <label class="col-sm-4" style="margin-top:7px;">Your password is</label>
                                    <div class="col-sm-6"><input class="form-control" type="text" value="<%= passwords[i] %>" disabled/></div>
                                </div>
                            <% } %>
                        <% } %>
                        <div class="form-group">
                            <div class="col-sm-4">
                                <a href="../index.jsp" class="btn btn-primary">Done</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>

\end{lstlisting}

\begin{lstlisting}[language=html,basicstyle=\tiny,caption=app.js]

jQuery(document).ready(function() {
    jQuery("#addQuestions").click(function() {
        var obj = jQuery("#selectQuestions option:selected");
        var num = +jQuery("#counter").text();
        if(jQuery("#selectQuestions").has('option').length > 0) {
            var element = "<div class='form-group'>" + "<label style='margin-top:7px;' class='col-sm-1'>" + num + "</label>"
                + "<label style='margin-top:7px;' class='col-sm-7'>" + obj.text() + "</label>" +
                "<div class='col-sm-4'><input id='quest' name='answer' type='text' class='form-control questions'/></div>"
                + "</div><input name='questions' type='hidden' value='" + obj.text() + "'/>";
            jQuery(".submit-buttons-hr").before(element);
        }
        jQuery("#selectQuestions option:selected").remove();
        num++;
        jQuery("#counter").text(num);
    });

    jQuery("#add").click(function() {
        var question = jQuery("#question").val();
        var num = +jQuery("#counter").text();
        if(question == "") {
            alert("Empty");
        } else {
            var element = "<div class='form-group'>"
                + "<label style='margin-top:7px;' class='col-sm-1'>" + num + "</label>"
                + "<label style='margin-top:7px;' class='col-sm-6'>" + question + "</label>"
                + "<div class='col-sm-4'><input id='quest' name='answer' type='text' class='form-control questions'/></div>"
                + "<a class='btn btn-danger' onclick='removeDiv(this)' style='margin-top:3px;'>"
                + "<span class='glyphicon glyphicon-remove-sign' aria-hidden='true'></span>"
                + "</a>"
                + "<input name='questions' type='hidden' value='" + question + "'/>"
                + "</div>";
            jQuery(".submit-buttons-hr").before(element);
            num++;
            jQuery("#counter").text(num);
        }
    });

    jQuery("#addPassword").click(function() {
        var element = "<div class='form-group' style='margin-top:10px;'>"
            + "<label for='pswd' style='margin-top:7px;' class='col-sm-1 control-label'>Password</label>"
            + "<label style='margin-top:7px;' class='col-sm-1'>:</label>"
            + "<div class='col-sm-9'><input id='pswd' name='password' type='password' class='form-control' required='required'/></div>"
            + "<a class='btn btn-danger' onclick='removeDiv(this)' style='margin-top:3px;'>"
            + "<span class='glyphicon glyphicon-remove-sign' aria-hidden='true'></span>"
            + "</a></div>";
        jQuery(".pswd-hr").before(element);
    });
});

function check() {
    var share = jQuery(".questions").length;
    var k = +jQuery(".k-value").val();
    if(share < k) {
        return false;
    } else {
        return true;
    }
}

function removeDiv(e) {
    jQuery(e).closest('div').remove();
}

function count() {
    var password = jQuery("input#pswd").length;
    if(password <= 0) {
        alert("Minimal 1 password");
        return false;
    }
    return true;
}

\end{lstlisting}

\begin{lstlisting}[language=html,basicstyle=\tiny,caption=style.css]

.main-container {
	margin: 0px auto;
	height: 500px;
}
.main-menu-links {
	margin: 0px auto;
	margin-top: 45vh;
	height: 200px;
	width: 600px;
	text-align: center;
}
tr,td {
	padding: 10px;
}

.password-input {
	width: 350px;
}

label {
	cursor: pointer !important;
}

.form-group {
	margin-bottom: 10px !important;
	height: 40px;
}
select.form-control {
	width: 90px;
	margin-bottom: 10px !important;
}

.failed-notification {
    background-color: #D9534F;
    color: #FFF;
    font-weight: bold;
    padding: 10px;
    border-radius: 5px;
    margin-left: 10px;
    margin-right: 10px;
}

\end{lstlisting}